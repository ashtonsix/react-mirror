{"version":3,"file":"index.js","sources":["src/cursor/cursor_naive.js","src/utils/createCursorAPI.js","src/utils/generateStoreId.js","src/utils/multicast/MulticastDisposable.js","src/utils/multicast/tryEvent.js","src/utils/multicast/dispose.js","node_modules/@most/prelude/dist/index.es.js","src/utils/multicast/MulticastSource.js","src/utils/multicast/Prioritise.js","src/utils/multicast/index.js","src/utils/Enum.js","src/utils/streams/combineValuesIntoEnum.js","src/utils/streams/eventSource.js","src/utils/streams/filterUnchangedKeyArrays.js","src/backend/backend.js","src/backend/index.js","src/bindings/scheduler.js","src/utils/shallowEqual.js","src/bindings/react.js","src/utils/handleActions.js","src/utils/streams/combineEnums.js","src/utils/streams/combineEventsWith.js","src/utils/streams/combineNested.js","src/utils/streams/combine.js","src/index.js"],"sourcesContent":["const traverse = (tree, onVisit) => {\n  const q = [tree]\n\n  while (q.length) {\n    const node = q.shift()\n    q.push(...Object.values(node.children))\n    onVisit(node)\n  }\n}\n\nconst getChildren = node => {\n  const children = []\n  traverse(node, node => children.push(node))\n  return children\n}\n\nconst getParents = node => {\n  const parents = []\n  while (node.parent) {\n    node = node.parent\n    parents.push(node)\n  }\n  return parents\n}\n\nconst testFilter = (node, filter) => {\n  if (!filter || filter === node.id || node.identifiers.includes(filter)) {\n    return true\n  }\n  return false\n}\n\nconst runQuery = (tree, originIds, query) => {\n  if (!query.length) return originIds\n\n  let operator\n  ;[operator, ...query] = query\n\n  if (operator.op === 'root') return runQuery(tree, [tree.id], query)\n\n  const originNodes = []\n  traverse(tree, node => {\n    if (originIds.includes(node.id)) {\n      originNodes.push(node)\n    }\n  })\n\n  const result = (() => {\n    let result = originNodes.map(node => {\n      const getMatches = operator.op === 'children' ? getChildren : getParents\n      let matches = getMatches(node)\n      matches = matches.filter(node => testFilter(node, operator.filter))\n      matches = matches.slice(0, operator.maxStores)\n      matches = matches.map(node => node.id)\n      return matches\n    })\n    result = [].concat(...result)\n    result = Array.from(new Set(result))\n    return result\n  })()\n\n  return runQuery(tree, result, query)\n}\n\nconst createCursorBackend = () => {\n  let prevTree\n\n  return {\n    query(origin, query) {\n      if (!prevTree) return []\n      return runQuery(prevTree, [origin], query)\n    },\n    updateNode(tree, op) {\n      prevTree = tree\n      const results = {}\n      traverse(tree, node => {\n        results[node.id] = node.queries.map(query => {\n          return runQuery(tree, [node.id], query)\n        })\n      })\n      return results\n    }\n  }\n}\n\nexport default createCursorBackend\n","const createCursorAPI = (enhancer, query = []) => {\n  const cursorMethods = {\n    root() {\n      const newQuery = [{op: 'root'}]\n      return createCursorAPI(enhancer, newQuery)\n    },\n    parents(filter = null, maxStores = Infinity) {\n      filter = filter && (filter.__COMPONENT_IDENTIFIER__ || filter)\n      const newQuery = query.concat({op: 'parents', filter, maxStores})\n      return createCursorAPI(enhancer, newQuery)\n    },\n    children(filter = null, maxStores = Infinity) {\n      filter = filter && (filter.__COMPONENT_IDENTIFIER__ || filter)\n      const newQuery = query.concat({op: 'children', filter, maxStores})\n      return createCursorAPI(enhancer, newQuery)\n    },\n    all(filter = null, maxStores = Infinity) {\n      filter = filter && (filter.__COMPONENT_IDENTIFIER__ || filter)\n      const newQuery = [{op: 'root'}, {op: 'children', filter, maxStores}]\n      return createCursorAPI(enhancer, newQuery)\n    },\n    one(filter = null) {\n      filter = filter && (filter.__COMPONENT_IDENTIFIER__ || filter)\n      const newQuery = [{op: 'root'}, {op: 'children', filter, maxStores: 1}]\n      return createCursorAPI(enhancer, newQuery)\n    },\n    parent(filter = null) {\n      filter = filter && (filter.__COMPONENT_IDENTIFIER__ || filter)\n      const newQuery = query.concat({op: 'parents', filter, maxStores: 1})\n      return createCursorAPI(enhancer, newQuery)\n    },\n    child(filter = null) {\n      filter = filter && (filter.__COMPONENT_IDENTIFIER__ || filter)\n      const newQuery = query.concat({op: 'children', filter, maxStores: 1})\n      return createCursorAPI(enhancer, newQuery)\n    }\n  }\n  return enhancer(cursorMethods, query)\n}\n\nexport default createCursorAPI\n","/*\n  Store ids should:\n\n    * Be easy to read / recognise\n    * Not conflict with filters\n    * Communicate how many components have been mounted during session\n*/\nconst ALPHABET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n\nconst counter = [0, -1]\n\nconst generateStoreId = () => {\n  for (let i = counter.length - 1; i >= 0; i--) {\n    if (counter[i] === 25) {\n      counter[i] = 0\n      if (!i) counter.unshift(0)\n    } else {\n      counter[i] += 1\n      break\n    }\n  }\n  return '_' + counter.map(char => ALPHABET[char]).join('')\n}\n\nexport const couldBeStoreId = RegExp.prototype.test.bind(/^_[A-Z]{2,12}$/)\n\nexport default generateStoreId\n","export default class MulticastDisposable {\n  constructor (source, sink) {\n    this.source = source\n    this.sink = sink\n    this.disposed = false\n  }\n\n  dispose () {\n    if (this.disposed) {\n      return\n    }\n    this.disposed = true\n    const remaining = this.source.remove(this.sink)\n    return remaining === 0 && this.source._dispose()\n  }\n}\n","export function tryEvent (t, x, sink) {\n  try {\n    sink.event(t, x)\n  } catch (e) {\n    sink.error(t, e)\n  }\n}\n\nexport function tryEnd (t, x, sink) {\n  try {\n    sink.end(t, x)\n  } catch (e) {\n    sink.error(t, e)\n  }\n}\n","export const dispose = disposable => disposable.dispose()\n\nexport const emptyDisposable = {\n  dispose () {}\n}\n","/** @license MIT License (c) copyright 2010-2016 original author or authors */\n\n// Non-mutating array operations\n\n// cons :: a -> [a] -> [a]\n// a with x prepended\nfunction cons(x, a) {\n  var l = a.length;\n  var b = new Array(l + 1);\n  b[0] = x;\n  for (var i = 0; i < l; ++i) {\n    b[i + 1] = a[i];\n  }\n  return b;\n}\n\n// append :: a -> [a] -> [a]\n// a with x appended\nfunction append(x, a) {\n  var l = a.length;\n  var b = new Array(l + 1);\n  for (var i = 0; i < l; ++i) {\n    b[i] = a[i];\n  }\n\n  b[l] = x;\n  return b;\n}\n\n// drop :: Int -> [a] -> [a]\n// drop first n elements\nfunction drop(n, a) {\n  // eslint-disable-line complexity\n  if (n < 0) {\n    throw new TypeError('n must be >= 0');\n  }\n\n  var l = a.length;\n  if (n === 0 || l === 0) {\n    return a;\n  }\n\n  if (n >= l) {\n    return [];\n  }\n\n  return unsafeDrop(n, a, l - n);\n}\n\n// unsafeDrop :: Int -> [a] -> Int -> [a]\n// Internal helper for drop\nfunction unsafeDrop(n, a, l) {\n  var b = new Array(l);\n  for (var i = 0; i < l; ++i) {\n    b[i] = a[n + i];\n  }\n  return b;\n}\n\n// tail :: [a] -> [a]\n// drop head element\nfunction tail(a) {\n  return drop(1, a);\n}\n\n// copy :: [a] -> [a]\n// duplicate a (shallow duplication)\nfunction copy(a) {\n  var l = a.length;\n  var b = new Array(l);\n  for (var i = 0; i < l; ++i) {\n    b[i] = a[i];\n  }\n  return b;\n}\n\n// map :: (a -> b) -> [a] -> [b]\n// transform each element with f\nfunction map(f, a) {\n  var l = a.length;\n  var b = new Array(l);\n  for (var i = 0; i < l; ++i) {\n    b[i] = f(a[i]);\n  }\n  return b;\n}\n\n// reduce :: (a -> b -> a) -> a -> [b] -> a\n// accumulate via left-fold\nfunction reduce(f, z, a) {\n  var r = z;\n  for (var i = 0, l = a.length; i < l; ++i) {\n    r = f(r, a[i], i);\n  }\n  return r;\n}\n\n// replace :: a -> Int -> [a]\n// replace element at index\nfunction replace(x, i, a) {\n  // eslint-disable-line complexity\n  if (i < 0) {\n    throw new TypeError('i must be >= 0');\n  }\n\n  var l = a.length;\n  var b = new Array(l);\n  for (var j = 0; j < l; ++j) {\n    b[j] = i === j ? x : a[j];\n  }\n  return b;\n}\n\n// remove :: Int -> [a] -> [a]\n// remove element at index\nfunction remove(i, a) {\n  // eslint-disable-line complexity\n  if (i < 0) {\n    throw new TypeError('i must be >= 0');\n  }\n\n  var l = a.length;\n  if (l === 0 || i >= l) {\n    // exit early if index beyond end of array\n    return a;\n  }\n\n  if (l === 1) {\n    // exit early if index in bounds and length === 1\n    return [];\n  }\n\n  return unsafeRemove(i, a, l - 1);\n}\n\n// unsafeRemove :: Int -> [a] -> Int -> [a]\n// Internal helper to remove element at index\nfunction unsafeRemove(i, a, l) {\n  var b = new Array(l);\n  var j = void 0;\n  for (j = 0; j < i; ++j) {\n    b[j] = a[j];\n  }\n  for (j = i; j < l; ++j) {\n    b[j] = a[j + 1];\n  }\n\n  return b;\n}\n\n// removeAll :: (a -> boolean) -> [a] -> [a]\n// remove all elements matching a predicate\n// @deprecated\nfunction removeAll(f, a) {\n  var l = a.length;\n  var b = new Array(l);\n  var j = 0;\n  for (var x, i = 0; i < l; ++i) {\n    x = a[i];\n    if (!f(x)) {\n      b[j] = x;\n      ++j;\n    }\n  }\n\n  b.length = j;\n  return b;\n}\n\n// findIndex :: a -> [a] -> Int\n// find index of x in a, from the left\nfunction findIndex(x, a) {\n  for (var i = 0, l = a.length; i < l; ++i) {\n    if (x === a[i]) {\n      return i;\n    }\n  }\n  return -1;\n}\n\n// isArrayLike :: * -> boolean\n// Return true iff x is array-like\nfunction isArrayLike(x) {\n  return x != null && typeof x.length === 'number' && typeof x !== 'function';\n}\n\n/** @license MIT License (c) copyright 2010-2016 original author or authors */\n\n// id :: a -> a\nvar id = function id(x) {\n  return x;\n};\n\n// compose :: (b -> c) -> (a -> b) -> (a -> c)\nvar compose = function compose(f, g) {\n  return function (x) {\n    return f(g(x));\n  };\n};\n\n// apply :: (a -> b) -> a -> b\nvar apply = function apply(f, x) {\n  return f(x);\n};\n\n// curry2 :: ((a, b) -> c) -> (a -> b -> c)\nfunction curry2(f) {\n  function curried(a, b) {\n    switch (arguments.length) {\n      case 0:\n        return curried;\n      case 1:\n        return function (b) {\n          return f(a, b);\n        };\n      default:\n        return f(a, b);\n    }\n  }\n  return curried;\n}\n\n// curry3 :: ((a, b, c) -> d) -> (a -> b -> c -> d)\nfunction curry3(f) {\n  function curried(a, b, c) {\n    // eslint-disable-line complexity\n    switch (arguments.length) {\n      case 0:\n        return curried;\n      case 1:\n        return curry2(function (b, c) {\n          return f(a, b, c);\n        });\n      case 2:\n        return function (c) {\n          return f(a, b, c);\n        };\n      default:\n        return f(a, b, c);\n    }\n  }\n  return curried;\n}\n\n// curry4 :: ((a, b, c, d) -> e) -> (a -> b -> c -> d -> e)\nfunction curry4(f) {\n  function curried(a, b, c, d) {\n    // eslint-disable-line complexity\n    switch (arguments.length) {\n      case 0:\n        return curried;\n      case 1:\n        return curry3(function (b, c, d) {\n          return f(a, b, c, d);\n        });\n      case 2:\n        return curry2(function (c, d) {\n          return f(a, b, c, d);\n        });\n      case 3:\n        return function (d) {\n          return f(a, b, c, d);\n        };\n      default:\n        return f(a, b, c, d);\n    }\n  }\n  return curried;\n}\n\n/** @license MIT License (c) copyright 2016 original author or authors */\n\nexport { cons, append, drop, tail, copy, map, reduce, replace, remove, removeAll, findIndex, isArrayLike, id, compose, apply, curry2, curry3, curry4 };\n//# sourceMappingURL=index.es.js.map\n","import MulticastDisposable from './MulticastDisposable'\nimport { tryEvent, tryEnd } from './tryEvent'\nimport { dispose, emptyDisposable } from './dispose'\nimport { remove, findIndex } from '@most/prelude'\n\nfunction insertWhen (x, a, f) {\n  const l = a.length\n  const b = new Array(l + 1)\n\n  let i = 0\n  for (; i < l; ++i) {\n    if (f(x, a[i])) {\n      break\n    }\n    b[i] = a[i]\n  }\n\n  b[i] = x\n\n  for (; i < l; ++i) {\n    b[i + 1] = a[i]\n  }\n\n  return b\n}\n\nfunction comparePriority (a, b) {\n  return (a.priority || 0) > (b.priority || 0)\n}\n\nexport default class MulticastSource {\n  constructor (source) {\n    this.source = source\n    this.sinks = []\n    this._disposable = emptyDisposable\n  }\n\n  run (sink, scheduler) {\n    const n = this.add(sink)\n    if (n === 1) {\n      this._disposable = this.source.run(this, scheduler)\n    }\n    return new MulticastDisposable(this, sink)\n  }\n\n  _dispose () {\n    const disposable = this._disposable\n    this._disposable = emptyDisposable\n    return Promise.resolve(disposable).then(dispose)\n  }\n\n  add (sink) {\n    this.sinks = insertWhen(sink, this.sinks, comparePriority)\n    return this.sinks.length\n  }\n\n  remove (sink) {\n    const i = findIndex(sink, this.sinks)\n    // istanbul ignore next\n    if (i >= 0) {\n      this.sinks = remove(i, this.sinks)\n    }\n\n    return this.sinks.length\n  }\n\n  event (time, value) {\n    const s = this.sinks\n    if (s.length === 1) {\n      return s[0].event(time, value)\n    }\n    for (let i = 0; i < s.length; ++i) {\n      tryEvent(time, value, s[i])\n    }\n  }\n\n  end (time, value) {\n    const s = this.sinks\n    for (let i = 0; i < s.length; ++i) {\n      tryEnd(time, value, s[i])\n    }\n  }\n\n  error (time, err) {\n    const s = this.sinks\n    for (let i = 0; i < s.length; ++i) {\n      s[i].error(time, err)\n    }\n  }\n}\n","class Prioritise {\n  constructor (priority, source) {\n    this.source = source\n    this.priority = priority\n  }\n  run (sink, scheduler) {\n    sink.priority = this.priority\n    return this.source.run(sink, scheduler)\n  }\n}\n\nexport default Prioritise\n","import MulticastSource from './MulticastSource'\nimport Prioritise from './Prioritise'\n\nfunction multicast (stream) {\n  const source = stream.source\n  return source instanceof MulticastSource\n    ? stream\n    : new stream.constructor(new MulticastSource(source))\n}\n\nfunction prioritise (priority, stream) {\n  return !stream\n    ? prioritise.bind(this, priority)\n    : new stream.constructor(new Prioritise(priority, stream.source))\n}\n\nexport {multicast, MulticastSource, prioritise, Prioritise}\n","class Enum extends Array {\n  constructor(obj = {}) {\n    const keys = Object.keys(obj)\n    const values = keys.map(key => obj[key])\n    super()\n    super.push(...values)\n    Object.defineProperty(this, 'keys', {value: keys})\n    Object.defineProperty(this, 'indexes', {\n      value: new Array(values.length).fill().map((v, i) => i)\n    })\n    keys.forEach(key => Object.defineProperty(this, key, {value: obj[key]}))\n  }\n  map(f) {\n    const obj = {}\n    this.forEach(function map(value, index, key, arr) {\n      obj[key] = f(value, index, key, arr)\n    })\n    return new Enum(obj)\n  }\n  filter(f) {\n    const obj = {}\n    this.forEach(function filter(value, index, key, arr) {\n      if (f(value, index, key, arr)) {\n        obj[key] = value\n      }\n    })\n    return new Enum(obj)\n  }\n  forEach(f) {\n    return super.forEach(function forEach(value, index, arr) {\n      return f(value, index, this.keys[index], arr)\n    })\n  }\n  every(f) {\n    return super.every(function every(value, index, arr) {\n      return f(value, index, this.keys[index], arr)\n    })\n  }\n  find(f) {\n    return super.find(function find(value, index, arr) {\n      return f(value, index, this.keys[index], arr)\n    })\n  }\n  findIndex(f) {\n    return super.findIndex(function findIndex(value, index, arr) {\n      return f(value, index, this.keys[index], arr)\n    })\n  }\n  some(f) {\n    return super.some(function some(value, index, arr) {\n      return f(value, index, this.keys[index], arr)\n    })\n  }\n  reduce(f) {\n    return super.reduce(function reduce(prev, value, index, arr) {\n      return f(prev, value, index, this.keys[index], arr)\n    })\n  }\n  reduceRight(f) {\n    return super.reduceRight(function reduceRight(prev, value, index, arr) {\n      return f(prev, value, index, this.keys[index], arr)\n    })\n  }\n}\n\nexport default Enum\n","import * as most from 'most'\nimport Enum from '../Enum'\n\nconst SKIP_TOKEN = '__MIRROR_SKIP_TOKEN__'\n\n/*\n  Combines streams of normal values into a stream of Enums\n\n  Emits values immediately, w/o waiting for input streams to emit their first value\n*/\nconst combineValuesIntoEnum = (streams, ids) => {\n  if (!streams.length) return most.of(new Enum())\n  return most.combineArray(\n    (...values) => {\n      const result = {}\n      values.forEach((value, i) => {\n        if (value !== SKIP_TOKEN) result[ids[i]] = value\n      })\n      return new Enum(result)\n    },\n    streams.map($stream => {\n      const $start = most.of(SKIP_TOKEN).until($stream)\n      return $start.concat($stream)\n    })\n  )\n}\n\nexport default combineValuesIntoEnum\n","import * as most from 'most'\n\nconst eventSource = () => {\n  let buffer = []\n  let next\n  let push = event => {\n    if (next) {\n      next(event)\n      next = null\n    } else {\n      buffer.push(event)\n    }\n  }\n  const setResolve = (resolve, reject) => (next = resolve)\n  function* eventGenerator() {\n    while (true) {\n      if (buffer.length) yield Promise.resolve(buffer.shift())\n      else yield new Promise(setResolve)\n    }\n  }\n  return {\n    push,\n    $stream: most.generate(eventGenerator)\n  }\n}\n\nexport default eventSource\n","const SKIP_TOKEN = '__MIRROR_SKIP_TOKEN__'\n\nconst keyArrayEqual = ({oldKeyArray, oldKeySet}, keyArray) => {\n  if (oldKeyArray === keyArray) return true\n  if (oldKeyArray === undefined) return false\n\n  for (let i in keyArray) {\n    if (!oldKeySet.has(keyArray[i])) return false\n  }\n\n  return keyArray.length === oldKeyArray.length\n}\n\nconst filterUnchangedKeyArrays = $stream => {\n  return $stream\n    .loop((seed, keyArray) => {\n      let isEqual = keyArrayEqual(seed, keyArray)\n      if (isEqual) return {seed, value: SKIP_TOKEN}\n      return {\n        seed: {oldKeyArray: keyArray, oldKeySet: new Set(keyArray)},\n        value: keyArray\n      }\n    }, {})\n    .filter(value => value !== SKIP_TOKEN)\n}\n\nexport default filterUnchangedKeyArrays\n","import * as most from 'most'\nimport invariant from 'invariant'\nimport warning from 'warning'\nimport createCursorBackend from '../cursor'\nimport createCursorAPI from '../utils/createCursorAPI'\nimport generateStoreId, {couldBeStoreId} from '../utils/generateStoreId'\nimport {multicast, prioritise} from '../utils/multicast'\nimport combineValuesIntoEnum from '../utils/streams/combineValuesIntoEnum'\nimport createEventSource from '../utils/streams/eventSource'\nimport filterUnchangedKeyArrays from '../utils/streams/filterUnchangedKeyArrays'\n\nconst createMirrorBackend = () => {\n  let root\n  const storeMap = {}\n  const cursorBackend = createCursorBackend()\n\n  const {push: onStoreUpdated, $stream: $storeUpdated} = createEventSource()\n\n  const $queryResults = $storeUpdated\n    .map(({store, op}) => {\n      return cursorBackend.updateNode(root, {path: store.path, op})\n    })\n    .multicast()\n\n  const updateStore = (\n    store,\n    {requesting = [], streams, identifiers = [], metadata = {}}\n  ) => {\n    Object.assign(store, {identifiers, metadata})\n\n    invariant(\n      !identifiers.some(couldBeStoreId),\n      'Cannot precede all-uppercase identifiers with \"_\" (\"%s\") because they could ' +\n        'conflict with internally-used IDs',\n      identifiers.find(couldBeStoreId)\n    )\n\n    const $storeDeleted = $queryResults.filter(() => !storeMap[store.id]).multicast()\n\n    let ADD_STREAMS_ASYNC\n\n    store.mirror = createCursorAPI((cursorMethods, query) => {\n      const cursor = {}\n      requesting.concat('$actions').forEach(streamName => {\n        Object.defineProperty(cursor, streamName, {\n          get() {\n            const queryIndex = store.queries.length\n            store.queries.push(query)\n            store.queryTypes.push(streamName)\n            store.queryResults.push([])\n            if (ADD_STREAMS_ASYNC) {\n              warning(\n                false,\n                'Accessing \"mirror.%s\" after a store has been added is inefficient, you ' +\n                  'can batch queries with `updateStore` to improve performance',\n                streamName\n              )\n              onStoreUpdated({store, op: 'update'})\n            }\n\n            const teardown = store => ({\n              type: 'TEARDOWN',\n              payload: undefined,\n              store\n            })\n\n            const $stream = $queryResults\n              .map(queryResults => {\n                return queryResults[store.id] ? queryResults[store.id][queryIndex] : []\n              })\n              .thru(filterUnchangedKeyArrays)\n              .map(stores => {\n                const prev = store.queryResults[queryIndex]\n                store.queryResults[queryIndex] = stores\n                const $stores = stores\n                  .map(id => {\n                    if (id === store.id && query.length && streamName === '$state') {\n                      return undefined\n                    }\n                    let $stream = storeMap[id] && storeMap[id].streams[streamName]\n                    if (store.id === id) $stream = $stream.thru(prioritise(-1))\n                    if ($stream && storeMap[id] && storeMap[id].tails[streamName]) {\n                      $stream = $stream.startWith(storeMap[id].tails[streamName])\n                    }\n                    return $stream\n                  })\n                  .filter(s => s)\n                if (streamName === '$actions') {\n                  const deletedStores = []\n                  const next = new Set(stores)\n                  for (const id of prev) if (!next.has(id)) deletedStores.push(id)\n                  return most\n                    .from(deletedStores.map(teardown))\n                    .concat(most.mergeArray($stores))\n                } else {\n                  return combineValuesIntoEnum($stores, stores)\n                }\n              })\n              .switchLatest()\n              .until($storeDeleted)\n\n            return streamName === '$actions'\n              ? $stream.concat(most.of(teardown(store.id)))\n              : $stream\n          }\n        })\n      })\n      Object.defineProperty(cursor, '$stores', {\n        get() {\n          return $queryResults\n            .map(() => ({\n              cursor: cursorBackend.query(store.id, query),\n              store\n            }))\n            .until($storeDeleted)\n        }\n      })\n      Object.assign(cursor, cursorMethods)\n      return cursor\n    })\n\n    store.dispatch = createCursorAPI((cursorMethods, query) => {\n      const dispatch = (type, payload, retryIfSelectionEmpty = true) => {\n        if (!storeMap[store.id]) {\n          warning(\n            false,\n            'Cannot dispatch actions (\"%s\") from a store (\"%s\") that does not exist',\n            type,\n            store.id\n          )\n          return\n        }\n        const stores = cursorBackend.query(store.id, query)\n        if (stores.length || !retryIfSelectionEmpty) {\n          stores.forEach(id => {\n            storeMap[id] && storeMap[id].streams.$actions.push({type, payload, store: id})\n          })\n          return\n        }\n\n        $queryResults\n          .until(\n            $storeDeleted.tap(() => {\n              warning(\n                false,\n                'No store matched an action (\"%s\"), & the dispatcher (\"%s\") was ' +\n                  \"removed. We've discarded the action. You could try dispatching the \" +\n                  'action via a proxy.',\n                type,\n                store.id\n              )\n            })\n          )\n          .map(() => cursorBackend.query(store.id, query))\n          .filter(stores => stores.length)\n          .take(1)\n          .observe(stores => {\n            stores.forEach(id => {\n              if (storeMap[id]) {\n                storeMap[id].streams.$actions.push({type, payload, store: id})\n              }\n            })\n          })\n      }\n      Object.assign(dispatch, cursorMethods)\n      return dispatch\n    })\n\n    if (!store.streams.$actions) {\n      const {push: dispatch, $stream: $actions} = createEventSource()\n      const initialize = {type: 'INITIALIZE', payload: undefined, store: store.id}\n      store.streams.$actions = $actions\n        .startWith(initialize)\n        .until($storeDeleted)\n        .thru(multicast)\n      store.streams.$actions.push = dispatch\n    }\n\n    if (streams) {\n      const _streams = streams(store.mirror, store.dispatch)\n      Object.keys(_streams).forEach(streamName => {\n        _streams[streamName] = _streams[streamName]\n          .tap(evt => (store.tails[streamName] = evt))\n          .thru(multicast)\n      })\n      store.streams = Object.assign(_streams, {\n        $actions: store.streams.$actions\n      })\n    }\n\n    ADD_STREAMS_ASYNC = true\n  }\n\n  const backend = {\n    addStore(parentId, {requesting, streams, identifiers, metadata}) {\n      if (!parentId) parentId = root && root.id\n      const parent = storeMap[parentId]\n      invariant(\n        parent || !root,\n        'Cannot add store as a child of \"%s\", because \"%s\" does not exist',\n        parentId,\n        parentId\n      )\n\n      const store = {\n        /*\n          '_AAC'\n        */\n        id: generateStoreId(),\n        /*\n          ['_AA', '_BX']\n        */\n        path: root ? parent.path.concat(parentId) : [],\n        /* {$actions, $state, $props} */\n        streams: {},\n        /*\n          {\n            $actions: {type: 'INCREMENT', payload: 1},\n            $state: {value: 2},\n            $props: {}\n          }\n        */\n        tails: {},\n        queries: [],\n        queryTypes: [],\n        queryResults: [],\n        children: {},\n        parent\n      }\n\n      if (store.parent) store.parent.children[store.id] = store\n\n      updateStore(store, {requesting, streams, identifiers, metadata})\n      storeMap[store.id] = store\n      onStoreUpdated({store, op: 'add'})\n\n      return store\n    },\n    removeStore(storeId) {\n      const store = storeMap[storeId]\n      if (!store) return\n      invariant(store !== root, 'Cannot remove root store')\n\n      const traverse = store => {\n        Object.values(store.children).forEach(traverse)\n        delete storeMap[store.id]\n        onStoreUpdated({store, op: 'remove'})\n      }\n      traverse(store)\n\n      if (store && store.parent) {\n        delete store.parent.children[storeId]\n      }\n    },\n    updateStore(storeId, {requesting, streams, identifiers, metadata}) {\n      const store = storeMap[storeId]\n      invariant(store, 'Cannot update a store (\"%s\") that does not exist', storeId)\n\n      updateStore(store, {requesting, streams, identifiers, metadata})\n      onStoreUpdated({store, op: 'update'})\n\n      return store\n    },\n    query: createCursorAPI((cursorMethods, query) => {\n      const runQuery = id => cursorBackend.query(id || root.id, query)\n      Object.assign(runQuery, cursorMethods)\n      return runQuery\n    }),\n    stores: storeMap\n  }\n\n  backend.root = root = backend.addStore(null, {\n    identifiers: ['MIRROR/root'],\n    metadata: {root: true}\n  })\n\n  return backend\n}\n\nexport default createMirrorBackend\n","import createMirrorBackend from './backend'\n\nconst MirrorBackend = createMirrorBackend()\n\nexport default MirrorBackend\n","import createEventSource from '../utils/streams/eventSource'\n\nconst createScheduler = () => {\n  const samplers = {}\n  let buffer = {}\n  let BUFFERING = false\n  return {\n    addStream(priority, id, $stream) {\n      samplers[id] = createEventSource()\n\n      return $stream\n        .tap(evt => {\n          buffer[id] = evt\n          if (!BUFFERING) {\n            BUFFERING = true\n            setTimeout(() => {\n              const _samplers = []\n              Object.keys(buffer).forEach(id => {\n                if (!_samplers[priority]) _samplers[priority] = []\n                if (samplers[id]) _samplers[priority].push(samplers[id])\n              })\n              _samplers.forEach(samplers => {\n                samplers.forEach(sampler => sampler.push(true))\n              })\n              BUFFERING = false\n              buffer = {}\n            })\n          }\n        })\n        .sampleWith(samplers[id].$stream)\n    },\n    removeStream(id) {\n      delete samplers[id]\n      delete buffer[id]\n    }\n  }\n}\n\nconst scheduler = createScheduler()\nexport default scheduler\n","const hasOwn = Object.prototype.hasOwnProperty\n\nconst shallowEqual = (a, b) => {\n  if (a === b) return true\n  if (typeof a !== 'object' || typeof b !== 'object' || !a !== !b) return false\n\n  let countA = 0\n  let countB = 0\n\n  for (let key in a) {\n    if (hasOwn.call(a, key) && a[key] !== b[key]) return false\n    countA++\n  }\n\n  for (let key in b) {\n    if (hasOwn.call(b, key)) countB++\n  }\n\n  return countA === countB\n}\n\nexport default shallowEqual\n","import * as most from \"most\";\nimport React from \"react\";\nimport warning from \"warning\";\nimport invariant from \"invariant\";\nimport scheduler from \"./scheduler\";\nimport MirrorBackend from \"../backend\";\nimport shallowEqual from \"../utils/shallowEqual\";\nimport createEventSource from \"../utils/streams/eventSource\";\n\nconst instantiseMapToProps = mapToProps => {\n  let CALLED_ONCE;\n  const instantisedMapToProps = (state, props) => {\n    let result = mapToProps(state, props);\n    if (!CALLED_ONCE && typeof result === \"function\") {\n      mapToProps = result;\n      result = mapToProps(state, props);\n    }\n    CALLED_ONCE = true;\n    return result;\n  };\n  return instantisedMapToProps;\n};\n\nfunction createMirrorDecorator(config = {}) {\n  return function decorateWithMirror(WrappedComponent) {\n    let { name = [], state, mapToProps, pure = true } = config;\n    if (!(name instanceof Array)) name = [name];\n    if (typeof mapToProps !== \"function\") {\n      mapToProps = (state, { withName, ...props }) => ({ ...props, ...state });\n    }\n    if (!pure)\n      pure = { propsEqual() {}, stateEqual() {}, propsStateEqual() {} };\n    if (pure === true) pure = {};\n    pure = Object.assign(\n      {\n        propsEqual: shallowEqual,\n        stateEqual: shallowEqual,\n        propsStateEqual: shallowEqual\n      },\n      pure\n    );\n\n    if (!WrappedComponent) {\n      WrappedComponent = function Noop() {\n        return null;\n      };\n    }\n    const _name =\n      WrappedComponent.displayName || WrappedComponent.name || \"Component\";\n    const stateless = !WrappedComponent.prototype.render;\n    invariant(\n      name.every(name => typeof name === \"string\"),\n      '`name` should be a string or array of strings (at \"%s\")',\n      _name\n    );\n\n    const getPropNames = (name = []) => {\n      if (!(name instanceof Array)) name = [name];\n      return name.filter(name => typeof name === \"string\").sort();\n    };\n\n    class Mirror extends React.Component {\n      constructor(props, context) {\n        super();\n        this.props = props;\n        this.state = { updateCount: 0, props: undefined };\n\n        let { push: onReceivedProps, $stream: $props } = createEventSource();\n        Object.assign(this, { onReceivedProps });\n\n        const { id, path, mirror, dispatch, streams } = MirrorBackend.addStore(\n          context.id,\n          {\n            requesting: [\"$state\", \"$props\"],\n            identifiers: [\n              ...name,\n              ...getPropNames(this.props.withName),\n              Mirror.__COMPONENT_IDENTIFIER__\n            ],\n            streams: (mirror, dispatch) => {\n              $props = $props\n                .startWith(props)\n                .skipRepeatsWith(pure.propsEqual.bind(this))\n                .tap(props => (this._props = props));\n              let $state =\n                typeof state === \"function\" &&\n                state.call(this, mirror, dispatch);\n              warning(\n                !state || ($state && $state.subscribe),\n                '`state` should return a stream, did you forget a \"return\" statement? (at \"%s\")',\n                [_name].concat(\n                  name.filter(name => typeof name === \"string\").join(\", \")\n                )\n              );\n              if (!state || !$state || !$state.subscribe) return { $props };\n              $state = $state\n                .skipRepeatsWith(pure.stateEqual.bind(this))\n                .filter(state => state !== undefined)\n                .tap(state => (this._state = state));\n              return { $state, $props };\n            },\n            metadata: {\n              instance: this\n            }\n          }\n        );\n        Object.assign(this, { id, depth: path.length, mirror, dispatch });\n\n        const $propsState = streams.$state\n          ? most.combine(\n              instantiseMapToProps(mapToProps.bind(this)),\n              streams.$state,\n              streams.$props\n            )\n          : streams.$props.map(\n              instantiseMapToProps(mapToProps.bind(this, undefined))\n            );\n\n        $propsState\n          .skipRepeatsWith(pure.propsStateEqual.bind(this))\n          .thru(scheduler.addStream.bind(null, this.depth, id))\n          .observe(propsState => {\n            this._propsState = propsState;\n            if (this._unmounted) return;\n            this.setState(({ updateCount }) => ({\n              updateCount: updateCount + 1,\n              propsState\n            }));\n          })\n          .then(scheduler.removeStream.bind(null, id));\n      }\n      getWrappedInstance() {\n        invariant(\n          !stateless,\n          \"Stateless components (eg, `() => {}`) don't have refs, and therefore can't be unwrapped.\"\n        );\n        return this.wrappedInstance;\n      }\n      getChildContext() {\n        return { id: this.id };\n      }\n      UNSAFE_componentWillReceiveProps(nextProps) {\n        const nextName = getPropNames(nextProps.withName);\n        const currentName = getPropNames(this.props.withName);\n        if (JSON.stringify(nextName) !== JSON.stringify(currentName)) {\n          MirrorBackend.updateStore(this.id, {\n            requesting: [\"$state\", \"$props\"],\n            identifiers: [\n              ...name,\n              ...nextName,\n              Mirror.__COMPONENT_IDENTIFIER__\n            ],\n            metadata: { instance: this }\n          });\n        }\n        this.onReceivedProps(nextProps);\n      }\n      shouldComponentUpdate(nextProps, nextState) {\n        return nextState.updateCount > this.state.updateCount;\n      }\n      componentWillUnmount() {\n        this._unmounted = true;\n        MirrorBackend.removeStore(this.id);\n      }\n      render() {\n        if (this.state.updateCount === 0 && state) {\n          return null;\n        }\n\n        const props = {\n          ...this.state.propsState,\n          dispatch: this.dispatch\n        };\n        if (!stateless) props.ref = ref => (this.wrappedInstance = ref);\n\n        return React.createElement(WrappedComponent, props);\n      }\n    }\n\n    Mirror.displayName = `Mirror(${_name})`;\n    Mirror.contextTypes = { id() {} };\n    Mirror.childContextTypes = { id() {} };\n    Mirror.__COMPONENT_IDENTIFIER__ = Mirror;\n\n    const createStaticCursors = () => {\n      delete Mirror.mirror;\n      delete Mirror.dispatch;\n      if (Mirror !== Mirror.__COMPONENT_IDENTIFIER__) {\n        Mirror.mirror = Mirror.__COMPONENT_IDENTIFIER__.mirror;\n        Mirror.dispatch = Mirror.__COMPONENT_IDENTIFIER__.dispatch;\n        return;\n      }\n\n      const { mirror, dispatch } = MirrorBackend.addStore(null, {\n        identifiers: [\"MIRROR/static\", `MIRROR/static/${_name}`],\n        requesting: [\"$props\", \"$state\"],\n        metadata: {\n          static: Mirror\n        }\n      });\n\n      Object.assign(Mirror, {\n        mirror: mirror.all(Mirror),\n        dispatch: dispatch.all(Mirror)\n      });\n    };\n\n    Object.defineProperties(Mirror, {\n      mirror: {\n        get: () => (createStaticCursors(), Mirror.mirror),\n        configurable: true\n      },\n      dispatch: {\n        get: () => (createStaticCursors(), Mirror.dispatch),\n        configurable: true\n      }\n    });\n\n    Mirror.__WITH_NAME_CACHE__ =\n      Mirror.__COMPONENT_IDENTIFIER__.__WITH_NAME_CACHE__ || {};\n\n    Mirror.withName = function withName(...withName) {\n      withName = name.concat(...withName);\n      const key = JSON.stringify(withName.sort());\n      const cachedComponent = Mirror.__WITH_NAME_CACHE__[key];\n      if (cachedComponent) return cachedComponent;\n\n      const renamedComponent = createMirrorDecorator({\n        ...config,\n        name: withName\n      })(WrappedComponent);\n      renamedComponent.__COMPONENT_IDENTIFIER__ =\n        Mirror.__COMPONENT_IDENTIFIER__;\n      if (withName.length) Mirror.__WITH_NAME_CACHE__[key] = renamedComponent;\n      return renamedComponent;\n    };\n\n    return Mirror;\n  };\n}\n\nexport default createMirrorDecorator;\n","const isAction = action => {\n  if (action && typeof action.type === 'string') {\n    return true\n  }\n  return false\n}\n\nconst findAction = args => {\n  let i = args.length\n  while (i--) {\n    if (isAction(args[i])) return args[i]\n    if (args[i] && isAction(args[i].action)) return args[i].action\n  }\n  return null\n}\n\nconst handleActions = (handlers, initialState) => (...args) => {\n  let action = findAction(args)\n  const state = args[0] === undefined ? initialState : args[0]\n\n  if (!action || !handlers[action.type]) return state\n  if (initialState !== undefined) return handlers[action.type](state, action)\n  return handlers[action.type](action)\n}\n\nexport default handleActions\n","import * as most from 'most'\nimport invariant from 'invariant'\nimport Enum from '../Enum'\n\nconst combineEnums = (...streams) => {\n  if (streams[0] instanceof Array) streams = streams[0]\n  invariant(\n    streams.every($stream => $stream && $stream.subscribe),\n    '`combineEnums` only accepts streams'\n  )\n  return most.combineArray((...enumCollection) => {\n    const result = {}\n    enumCollection.forEach(_enum_ => {\n      _enum_.forEach((value, i, key) => {\n        result[key] = value\n      })\n    })\n    return new Enum(result)\n  }, streams)\n}\n\nexport default combineEnums\n","import invariant from 'invariant'\n\nconst combineEventsWithDefault = (eventStream, otherStream) => {\n  otherStream = otherStream.scan(([, before], after) => [before, after], []).multicast()\n  return otherStream\n    .sample(\n      (event, [before, after]) => ({before, event, after}),\n      eventStream,\n      otherStream\n    )\n    .skipRepeatsWith((a, b) => a.event === b.event)\n}\n\nconst combineEventsWithBefore = (eventStream, otherStream) => {\n  return eventStream.sample(\n    (event, other) => ({before: other, event}),\n    eventStream,\n    otherStream\n  )\n}\n\nconst combineEventsWithAfter = (eventStream, otherStream) => {\n  return combineEventsWithDefault(eventStream, otherStream).map(value => {\n    delete value.before\n    return value\n  })\n}\n\nconst combineEventsWithNothing = eventStream => {\n  return eventStream.map(event => ({event}))\n}\n\nconst combineEventsWith = (\n  eventStream,\n  otherStream,\n  options = {before: true, after: true}\n) => {\n  invariant(\n    eventStream && otherStream && eventStream.subscribe && otherStream.subscribe,\n    '`combineEventsWith` only accepts streams'\n  )\n  if (options.before && options.after) {\n    return combineEventsWithDefault(eventStream, otherStream)\n  } else if (options.before) {\n    return combineEventsWithBefore(eventStream, otherStream)\n  } else if (options.after) {\n    return combineEventsWithAfter(eventStream, otherStream)\n  }\n\n  return combineEventsWithNothing(eventStream)\n}\n\nexport default combineEventsWith\n","import * as most from 'most'\nimport invariant from 'invariant'\nimport Enum from '../Enum'\n\nconst combineNested = streamMap => {\n  const keys = Object.keys(streamMap)\n  const streams = keys.map(key => streamMap[key])\n  invariant(\n    streams.every($stream => $stream && $stream.subscribe),\n    '`combineNested` only accepts streams'\n  )\n  return most.combineArray((...enumCollection) => {\n    const result = {}\n    enumCollection.forEach(_enum_ => {\n      _enum_.forEach((value, i, key) => {\n        if (!result[key]) result[key] = {}\n        result[key][keys[i]] = value\n      })\n    })\n    return new Enum(result)\n  }, streams)\n}\n\nexport default combineNested\n","import * as most from 'most'\nimport invariant from 'invariant'\n\nconst combine = (...streams) => {\n  if (streams[0] instanceof Array) streams = streams[0]\n  invariant(\n    streams.every($stream => $stream && $stream.subscribe),\n    '`combine` only accepts streams'\n  )\n  return most.combineArray((...values) => [...values], streams)\n}\n\nexport default combine\n","import 'regenerator-runtime/runtime'\nimport MirrorBackend from './backend'\nimport Mirror from './bindings'\nimport Enum from './utils/Enum'\nimport handleActions from './utils/handleActions'\nimport shallowEqual from './utils/shallowEqual'\nimport combineEnums from './utils/streams/combineEnums'\nimport combineEventsWith from './utils/streams/combineEventsWith'\nimport combineNested from './utils/streams/combineNested'\nimport combine from './utils/streams/combine'\n\nconst {addStore, removeStore, updateStore, query, root, stores} = MirrorBackend\n\nexport {addStore, removeStore, updateStore, query, root, stores}\nexport {handleActions, Enum, shallowEqual}\nexport {combineEnums, combineEventsWith, combineNested, combine}\nexport default Mirror\n"],"names":["traverse","tree","onVisit","q","length","node","shift","push","Object","values","children","getChildren","getParents","parents","parent","testFilter","filter","id","identifiers","includes","runQuery","originIds","query","operator","op","originNodes","result","map","getMatches","matches","slice","maxStores","concat","Array","from","Set","createCursorBackend","prevTree","origin","results","queries","createCursorAPI","enhancer","cursorMethods","newQuery","Infinity","__COMPONENT_IDENTIFIER__","ALPHABET","counter","generateStoreId","i","unshift","char","join","couldBeStoreId","RegExp","prototype","test","bind","MulticastDisposable","source","sink","disposed","remaining","remove","_dispose","tryEvent","t","x","event","e","error","tryEnd","end","dispose","disposable","emptyDisposable","insertWhen","a","f","l","b","comparePriority","priority","MulticastSource","sinks","_disposable","scheduler","n","add","run","Promise","resolve","then","findIndex","time","value","s","err","Prioritise","multicast","stream","constructor","prioritise","Enum","obj","keys","key","defineProperty","fill","v","forEach","index","arr","every","find","some","reduce","prev","reduceRight","SKIP_TOKEN","combineValuesIntoEnum","streams","ids","most","$start","until","$stream","eventSource","eventGenerator","buffer","next","setResolve","reject","keyArrayEqual","keyArray","oldKeyArray","oldKeySet","undefined","has","filterUnchangedKeyArrays","loop","seed","isEqual","createMirrorBackend","root","storeMap","cursorBackend","createEventSource","onStoreUpdated","$storeUpdated","$queryResults","store","updateNode","path","updateStore","requesting","metadata","assign","$storeDeleted","ADD_STREAMS_ASYNC","mirror","cursor","streamName","queryIndex","queryTypes","queryResults","teardown","thru","stores","$stores","tails","startWith","deletedStores","switchLatest","dispatch","type","payload","retryIfSelectionEmpty","$actions","tap","take","observe","initialize","_streams","evt","backend","parentId","storeId","addStore","MirrorBackend","createScheduler","samplers","BUFFERING","_samplers","sampler","sampleWith","hasOwn","hasOwnProperty","shallowEqual","countA","countB","call","instantiseMapToProps","CALLED_ONCE","instantisedMapToProps","state","props","mapToProps","createMirrorDecorator","config","decorateWithMirror","WrappedComponent","name","pure","withName","Noop","_name","displayName","stateless","render","getPropNames","sort","Mirror","context","updateCount","onReceivedProps","$props","skipRepeatsWith","propsEqual","_props","$state","subscribe","stateEqual","_state","depth","$propsState","propsStateEqual","addStream","_propsState","propsState","_unmounted","setState","removeStream","wrappedInstance","nextProps","nextName","currentName","JSON","stringify","instance","nextState","removeStore","ref","React","createElement","Component","contextTypes","childContextTypes","createStaticCursors","all","defineProperties","__WITH_NAME_CACHE__","cachedComponent","renamedComponent","isAction","action","findAction","args","handleActions","handlers","initialState","combineEnums","enumCollection","combineEventsWithDefault","eventStream","otherStream","scan","after","before","sample","combineEventsWithBefore","other","combineEventsWithAfter","combineEventsWithNothing","combineEventsWith","options","combineNested","streamMap","combine"],"mappings":"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"}